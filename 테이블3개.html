<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style/reset.css">
    <link rel="stylesheet" href="style/default.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>

    <style>
        .main__echart {
            border: 1px solid blue;
        }

        .chartBox {
            background: #F8F8F8;
            min-height: 40rem;
            border-top: 1px solid #E5E5E5;
            /* padding: 3rem 1rem 0rem 1rem; */
            padding: 3rem 3.5rem;
        }

        .chart1,
        .chart2 {
            width: 320px;
        }

        #tableList tbody tr.on {
            background-color: #85f1f5;
        }


        /* .table, .chart1, .chart2 {
        width: 30%;
        margin: 10px;
        height: 100%;
        } */


        .chartBox>div {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #tableList tbody tr.on {
            background-color: #85f1f5;
        }

        .table>#tableList {
            min-height: 40rem;
        }

        .main__echart .table tbody td {
            height: 6.5rem;
        }

        .main__echart .table th {
            height: 6.5rem;
        }

        /* .main__echart .echart {width: 100%; height: 18.8rem;} */

        /* .main__echart .chartBox > .echart {border: 1px solid red;} */
    </style>
</head>

<body>
    <div class="main__echart">
        <div class="inner flex--box-c" style="align-items: stretch;">
            <div class="table table__vertical">
                <!-- <h2 class="title relative">노동조합 회계공시<span>(단위 : 천원)</span></h2> -->
                <table class="tdHover" id="tableList">
                    <caption>노동조합 회계공시(노동조합명, 총연합, 자산, 부채, 수입, 지출)</caption>
                    <colgroup>
                        <col width="30%">
                        <col width="15%">
                        <col>
                        <col>
                        <col>
                        <col width="11%">
                    </colgroup>
                    <thead>
                        <tr>
                            <th>노동조합명</th>
                            <th>총연합</th>
                            <th>자산</th>
                            <th>부채</th>
                            <th>수입</th>
                            <th>지출</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="">
                            <td class="txt--l"> (1) abc노동조합</td>
                            <td class="txt_l">abc총연맹</td>
                            <td>1,590</td>
                            <td>210</td>
                            <td>120</td>
                            <td>115</td>
                        </tr>
                        <tr class="on">
                            <td class="txt--l"> (2) ○○기업 노동조합</td>
                            <td class="txt_l">○○총연맹</td>
                            <td>2,360</td>
                            <td>1,250</td>
                            <td>870</td>
                            <td>643</td>
                        </tr>
                        <tr>
                            <td class="txt--l"> (3) ▲▲지역지회</td>
                            <td class="txt_l">총연합단체미가입</td>
                            <td>3,150</td>
                            <td>2,420</td>
                            <td>1,120</td>
                            <td>1,098</td>
                        </tr>
                        <tr>
                            <td class="txt--l"> (4) △△기업분회</td>
                            <td class="txt_l">기타</td>
                            <td>1,320</td>
                            <td>357</td>
                            <td>254</td>
                            <td>204</td>
                        </tr>
                        <tr>
                            <td class="txt--l"> (5) □□산업노동조합</td>
                            <td class="txt_l">□□총연맹</td>
                            <td>315</td>
                            <td>25</td>
                            <td>90</td>
                            <td>84</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="chart1">
                <!-- 				<div class="chartBox" id="mainChartDiv"><canvas id="mainChart" width="100%" height="100%"></canvas></div> -->
                <div class="chartBox">
                    <h2 class="title" style="margin-bottom: 32px;">자산 부채 현황<span>(단위 : 천원)</span></h2>
                    <div id="pieChart" class="echart" style="width: 100%; min-height: 18.8rem; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); position: relative;" _echarts_instance_="ec_1724498288483">
      
                        <!-- <div style="position: relative; padding: 0px; margin: 0px; border-width: 0px;">
                            <canvas data-zr-dom-id="zr_0" style="width: 18.8rem; height: 18.8rem; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0px; margin: 0px; border-width: 0px;">
                            </canvas></div>
                        <div class=""></div> -->
                    </div>
                    <div class="chartData__wrap">
                        <div class="data">
                            <h2>자산</h2>
                            <p>데이터</p>
                        </div>
                        <div class="data" id="dataEx">
                            <h2>자산</h2>
                            <p>데이터</p>
                        </div>
                        <div id="dataDisplay"></div>
                    </div>
                </div>
            </div>
            <div class="chart2">
                <!-- 				<div class="chartBox" id="mainChartDiv2"><canvas id="mainChart2" width="100%" height="100%"></canvas></div> -->
                <div class="chartBox">
                    <h2 class="title">수입 지출 현황<span>(단위 : 천원)</span></h2>
                    <div>
                        <div id="barChart" class="echart" style="width: 100%; height: 100%; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); position: relative;" _echarts_instance_="ec_1724498288484">
                            <div style="position: relative; width: 236px; height: 236px; padding: 0px; margin: 0px; border-width: 0px;"><canvas data-zr-dom-id="zr_0" width="236" height="236" style="position: absolute; left: 0px; top: 0px; width: 236px; height: 236px; user-select: none; -webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0px; margin: 0px; border-width: 0px;"></canvas></div>
                            <div class=""></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
<script src="
https://cdn.jsdelivr.net/npm/echarts@5.5.1/dist/echarts.min.js
"></script>
<script>




    $(document).ready(function() {

   
        //처음에 첫번째 데이터 선택

        //테이블 tr 선택 차트출력
        $("#tableList tbody").on("click", "tr", function(e) {
            var trNum = $(e.target).closest('tr').prevAll().length;
            cnt = trNum;
            //튤팁제거(선택시 튤팁이 생기므로)
            $(".tooltip").remove();

            var d = parseInt(($(this).find("td:eq(2)").text()).replace(",", "")); //자산-자본
            var e = parseInt(($(this).find("td:eq(3)").text()).replace(",", "")); //부채
            var f = parseInt(($(this).find("td:eq(4)").text()).replace(",", "")); //수익
            var g = parseInt(($(this).find("td:eq(5)").text()).replace(",", "")); //지출

            $('#dataEx p').html(e)
            $('#dataEx p').html(d)


            // 파이 차트 옵션
            var pieChartOption = {
                tooltip: {
                    trigger: 'item',
                    confine:true
                },
                // legend: {
                //     orient: 'horizontal',
                //     // top: 5,
                //     itemWidth: 16,
                //     itemHeight: 16
                // },
                
                series: [{
                    // top: 0,
                    type: 'pie',
                    radius: ['42.6%', '100%'],
                    label: {
                        // show: true,
                        // position: 'inside',
                        // fontSize: 18,
                        // formatter: function(d) {
                        // 	if(d.value == 0) return '';
                        // 	return gfnAddCommas(d.value);
                        // }
                    },
                    emphasis: {
                        // itemStyle: {
                        //     shadowBlur: 10,
                        //     shadowOffsetX: 0,
                        //     shadowColor: 'rgba(0, 0, 0, 0.5)'
                        // }
                    },
                    data: [{
                            value: d,
                            name: '자산',
                            itemStyle: {
                                color: '#005187'
                            }
                        },
                        {
                            value: e,
                            name: '부채',
                            itemStyle: {
                                color: '#00BA63'
                            }
                        }
                    ]
                }]
            };


            var pieChart = echarts.init(document.querySelector("#pieChart"));
            pieChart.setOption(pieChartOption);

            // pieChart.on('mouseover', function (params) {
            // // 데이터 바인딩
            // var dataDisplay = document.getElementById('dataDisplay');
            // dataDisplay.innerHTML = '항목: ' + params.name + '<br>값: ' + params.value + ' 천원';
            // });



            // 바 차트 옵션
            var barChartOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                grid: {
                    top: '3%',
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: [{
                    type: 'category',
                    data: ['수입', '지출']
                }],
                yAxis: [{
                    type: 'value'
                }],
                series: [{
                    type: 'bar',
                    label: {
                        show: true,
                        fontSize: 18,
                        // formatter: function(d) {
                        // 	return gfnAddCommas(d.value);
                        // }
                    },
                    emphasis: {
                        focus: 'series'
                    },
                    data: [{
                            value: f,
                            itemStyle: {
                                color: 'rgb(115,192,220)'
                            }
                        },
                        {
                            value: g,
                            itemStyle: {
                                color: 'rgb(86,113,195)'
                            }
                        }
                    ]
                }]
            };

            var barChart = echarts.init(document.querySelector("#barChart"));
            barChart.setOption(barChartOption);



            $("#tableList tbody tr").removeClass('on');
            $(this).addClass('on');
        });


        fn_tblClick();

        setInterval(function() {
            fn_tblClickInterval();
        }, 10000);

        $("#popup .float").on("click", function(event) {
            setCookie("mainPopup", "Y", 1);
            $("#popup").fadeOut(400);
        });
    });

    function fn_tblClick() {
        $("#tableList tbody tr:first").click();
    }

    function fn_tblClickInterval() { 
        cnt += 1; // 카운트 늘어나고
        if (cnt == 5) { // 끝나면 초기화
            cnt = 0;
        }
        $("#tableList tbody tr:eq(" + cnt + ")").click(); // 클릭 시 이벤트 전달해서 데이터 바인딩
    }

    // function setCookie(name, value, exDay) {
    //     var todayDate = new Date();
    //     todayDate.setDate(todayDate.getDate() + exDay);
    //     document.cookie = name + "=" + escape(value) + "; path=/; expires=" + todayDate.toGMTString() + ";";
    // }

    // function closeToday() {
    //     $("#popup").fadeOut(400);
    //     $(".bgPopup").fadeOut(400);
    //     setCookie("popup", "done", 1);
    // }
</script>

</html>